<?xml version="1.0"?>
<TeamMentor_Article Metadata_Hash="378667225" Content_Hash="-563042629">
  <Metadata>
    <Id>1408d3c3-7fc1-4ff0-910e-cdf0e191b669</Id>
    <Id_History>c392a633-2f74-4557-94ba-9fd6eeeefb95,1408d3c3-7fc1-4ff0-910e-cdf0e191b669,96c4e378-082a-466c-9279-bf256f035c00,</Id_History>
    <Library_Id>be5273b1-d682-4361-99d9-6204f2d47eb7</Library_Id>
    <Title>Client-side Validation Attack</Title>
    <Category>Input and Data Validation</Category>
    <Phase>Implementation</Phase>
    <Technology> Any</Technology>
    <Type>Attack</Type>
    <DirectLink>Client-side Validation Attack</DirectLink>
    <Tag />
    <Security_Demand />
    <Author />
    <Priority>1</Priority>
    <Status />
    <Source>SI</Source>
  </Metadata>
  <Content Sanitized="true" DataType="wikitext">
    <Data><![CDATA[=Applies To

All network applications.

=Description

From an attacker's perspective, client network applications — such as an email client or web browser — are viewed simply as a user interface for generating network requests which are subsequently sent to a server. The client application is simply a tool that may be used to generate requests, but it is never a requirement that the attacker actually use this tool. Any network messages sent by the client can be monitored by the attacker, enabling them to write a separate tool to generate the same requests. In this scenario, it is impossible for the server to tell whether the request was generated by the real client application or by the attacker's custom tool.

Consequently, any validation checks performed by the client on the data sent to the server can be easily bypassed by writing a new malicious client application that does not perform this validation. While client-side validation is  important for enhancing the user experience and general application usability, it should not be relied on for security. The same validation checks should always be made on the server to ensure that the all input received by the server is valid.

=Impact

    *Subversion of application-specific business rules (see example).
    *Server-side code injection such as SQL injection, XML injection and LDAP injection.
    *Execution of malicious code due to input, causing a buffer overflow or similar condition.
    *Information disclosure, such as created by path manipulation or canonicalization.
    *Denial of service caused by unconstrained or poorly formatted input.

=Vulnerabilities

    *Failure to validate user input on the server.
    *Inconsistent validation between client-side and server-side validation.

=Countermeasures

    *Constrain input on the server: Use vigorous white-list style checking on any user input that is provided by the client.
    *Validate input on the server: Assume input is malicious until proven otherwise. Even if the input is coming from a client that does validation, do not accept the input until it has been validated by the server. Client-side validation is for usability; server side validation is for security.
    *Use whitelists for input validation: Malicious input comes in many forms. Guard against as many of them as possible by using an inclusion list of known good inputs, and reject everything else.

=Example

The classic example of a client-side validation attack occurs with a common e-commerce web site. Consider a standard checkout form that allows the shopper to enter the desired quantity of a particular item. The page that displays this form contains Javascript that validates if the value entered is positive. However, the server-side code that processes the request sent by this page does not validate this field. Instead, it assumes that the Javascript validation is sufficient. This incorrect assumption allows an attacker to generate a custom HTTP request with a negative value for the quantity field. Under some circumstances, such a request could result in crediting the attacker's bank account.

=Additional Resources

    *For more information on OWASP's Have Your Cake and Eat It Too, see: https://www.owasp.org/index.php/Have_Your_Cake_and_Eat_It_Too
    *For more information on Validating Input for PHP, see: http://www.tuxradar.com/practicalphp/7/7/0
    *For more information on PHP security, see: http://php.robm.me.uk/

=Related Items

    *[[9d60faca-687b-4c69-91ba-f5712af0fd02|Attack: Server-Side Code Injection Attack]]
    *[[7facca81-ff33-4c7a-862b-e2af2be44e94|Attack: File Name and Path Manipulation Attack]]
    *[[8698cde2-0fdf-4676-a043-ae90e62f55b8|Attack: Command Injection Attack]]
    *[[4c56f015-31b0-4570-a194-707d9cf6db26|Attack: Business Rule Attack]]
    *[[8482159c-5ec2-4b89-9c65-9af765030ff5|Attack: Information Disclosure Attack]]
    *[[468c8d7a-ffc6-49ad-bef5-1886fd809a96|Attack: Denial of Service Attack]]

]]></Data>
  </Content>
</TeamMentor_Article>